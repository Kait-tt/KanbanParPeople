<%
var stages = [
    {name: 'todo', displayName: 'TODO'},
    {name: 'doing', displayName: 'Doing'},
    {name: 'review', displayName: 'Review'},
    {name: 'done', displayName: 'Done'}
];

%>
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/kanban.css'/>
</head>
<body>
<div class="main">
    <div class="container">
        <h1><%= title %></h1>
    </div>

    <div class="blocks">

        <ul class="stage-blocks">
            <li id="issues-block" class="stage-block">
                <h2 class="stage-title">Issues</h2>
                <ul class="cell-block" data-bind="foreach: issues">
                    <li data-bind="if: assignee === null">
                        <p class="card" data-bind="text: title"></p>
                    </li>
                </ul>
            </li>

            <% stages.forEach(function (stage) { %>

            <li id="<%= stage.name %>-block" class="stage-block">
                <h2 class="stage-title"><%= stage.displayName %></h2>
                <ul class="cell-block" data-bind="foreach: {
                data: members,
                afterAdd: effects.slideDown,
                beforeRemove: effects.slideUp }">
                    <li class="dummy-user-cell-block"></li>
                </ul>
            </li>

            <% }); %>
        </ul>

        <ul class="user-blocks" data-bind="foreach: {
                data: members,
                afterAdd: effects.slideDown,
                beforeRemove: effects.slideUp }">
            <li class="user-block">
                <p class="user-name">
                    <button type="button" class="close" aria-label="Close" data-bind="
                    click: $root.removeMember">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <span data-bind="text: userName"></span>
                </p>

                <ul class="stage-blocks">
                    <li id="todo-block" class="stage-block">
                        <div class="user-cell-block">
                            <ul class="card-list" data-bind="foreach: todo">
                                <li class="card" data-bind="text: title"></li>
                            </ul>
                        </div>
                    </li>
                    <li id="doing-block" class="stage-block">
                        <div class="user-cell-block">
                            <ul class="card-list" data-bind="foreach: doing">
                                <li class="card" data-bind="text: title"></li>
                            </ul>
                        </div>
                    </li>
                    <li id="review-block" class="stage-block">
                        <div class="user-cell-block">
                            <ul class="card-list" data-bind="foreach: review">
                                <li class="card" data-bind="text: title"></li>
                            </ul>
                        </div>
                    </li>
                    <li id="done-block" class="stage-block">
                        <div class="user-cell-block">
                            <ul class="card-list" data-bind="foreach: done">
                                <li class="card" data-bind="text: title"></li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </li>
        </ul>
    </div>

    <% include alert %>
</div>

<!-- javascript -->
<script src="/vendor/jquery/dist/jquery.min.js"></script>
<script src="/vendor/underscore/underscore-min.js"></script>
<script src="/vendor/knockoutjs/dist/knockout.js"></script>
<script src="/socket.io/socket.io.js"></script>

<script src="/javascripts/module/util.js"></script>
<script src="/javascripts/model/Issue.js"></script>
<script src="/javascripts/model/User.js"></script>
<script src="/javascripts/model/Project.js"></script>
<script src="/javascripts/model/Projects.js"></script>
<script src="/javascripts/view/effects.js"></script>
<script src="/javascripts/viewmodel/Alert.js"></script>
<script src="/javascripts/viewmodel/Kanban.js"></script>
<script src="/javascripts/roots/kanban.js"></script>
</body>
</html>
